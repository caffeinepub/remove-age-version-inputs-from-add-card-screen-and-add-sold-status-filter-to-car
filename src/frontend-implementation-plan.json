{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Add sold-cards purchase total metric (excluding Essence) to portfolio sold-balance summary",
  "requirements": [
    {
      "id": "REQ-2",
      "summary": "Add a \"Purchase total\" metric to the sold-cards balance summary that sums discounted purchase prices for sold non-Essence cards and displays it left of \"Sale proceeds\".",
      "acceptanceCriteria": [
        "The \"Bilanz verkaufter Karten\" summary grid shows a new tile/row item labeled \"Purchase total\" placed immediately before (to the left of) the \"Sale proceeds\" tile on desktop layouts.",
        "\"Purchase total\" equals the sum over sold cards of `purchasePrice * (1 - discountPercent/100)` for non-Essence payment methods; sold cards with payment method `essence` contribute 0.",
        "The displayed purchase total is formatted as a euro amount with 2 decimals (e.g., €12.34).",
        "The sold-card balance value shown continues to match the backend `getSoldCardBalance()` result after REQ-1 is implemented."
      ],
      "file_operations": [
        {
          "path": "frontend/src/pages/PortfolioPage.tsx",
          "operation": "modify",
          "description": "Update the \"Bilanz verkaufter Karten\" section to (1) fetch sold cards via existing transaction-group data, (2) compute a \"Purchase total\" as the sum of discounted purchase prices for sold cards excluding PaymentMethod.essence, (3) render a new summary tile labeled \"Purchase total\" positioned immediately left of the existing \"Verkaufserlöse\" tile on desktop by reordering tiles and adjusting the responsive grid columns (e.g., md grid from 3 to 4 columns), and (4) format the amount as euro with 2 decimals."
        }
      ]
    }
  ]
}